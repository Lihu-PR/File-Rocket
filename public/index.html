<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File-Rocket - æé€Ÿæ–‡ä»¶ä¼ è¾“</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="icon" type="image/svg+xml" id="favicon" href="favicon-classic.svg">
    <!-- ä¸»é¢˜åˆå§‹åŒ–ï¼ˆé˜²æ­¢é—ªçƒï¼‰ -->
    <script>
        (function() {
            var theme = localStorage.getItem('file-rocket-theme') || 'minimal';
            if (theme !== 'classic') {
                document.documentElement.setAttribute('data-theme', theme);
            }
            var fav = document.getElementById('favicon');
            if (fav) fav.href = theme === 'minimal' ? 'favicon-minimal.svg' : 'favicon-classic.svg';
        })();
    </script>
</head>
<body>
    <!-- SVG å›¾æ ‡å¼•ç”¨ -->
    <svg style="display:none">
        <symbol id="icon-logo" viewBox="0 0 32 32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M16 2L4 8V24L16 30L28 24V8L16 2Z"/>
            <path d="M4 8L16 14L28 8"/>
            <path d="M16 14V22"/>
        </symbol>
        <symbol id="icon-upload" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
            <polyline points="17 8 12 3 7 8"/>
            <line x1="12" y1="3" x2="12" y2="15"/>
        </symbol>
        <symbol id="icon-download" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
            <polyline points="7 10 12 15 17 10"/>
            <line x1="12" y1="15" x2="12" y2="3"/>
        </symbol>
        <symbol id="icon-lock" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
            <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
        </symbol>
        <symbol id="icon-zap" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>
        </symbol>
        <symbol id="icon-globe" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"/>
            <line x1="2" y1="12" x2="22" y2="12"/>
            <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
        </symbol>
        <symbol id="icon-key" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"/>
        </symbol>
    </svg>

    <div class="container">
        <header class="header">
            <div class="logo">
                <span class="emoji-icon">ğŸš€</span>
                <svg class="svg-icon icon-lg" style="display:none"><use href="#icon-logo"/></svg>
                <span>File-Rocket</span>
            </div>
            <p class="subtitle">æ–°ä¸€ä»£å®‰å…¨æµå¼æ–‡ä»¶ä¼ è¾“</p>
        </header>

        <main class="main-content">
            <div class="action-cards">
                <div class="card" onclick="goToUpload()">
                    <div class="card-icon">
                        <span class="emoji-icon">ğŸ“¤</span>
                        <svg class="svg-icon icon-2xl" style="display:none"><use href="#icon-upload"/></svg>
                    </div>
                    <h3>å‘é€æ–‡ä»¶</h3>
                    <p>æé€Ÿæµå¼ä¸Šä¼ ï¼Œç”Ÿæˆä¸“å±å–ä»¶ç </p>
                    <button class="btn-primary">å¼€å§‹å‘é€</button>
                </div>

                <div class="card" onclick="goToReceive()">
                    <div class="card-icon">
                        <span class="emoji-icon">ğŸ“¥</span>
                        <svg class="svg-icon icon-2xl" style="display:none"><use href="#icon-download"/></svg>
                    </div>
                    <h3>æ¥æ”¶æ–‡ä»¶</h3>
                    <p>è¾“å…¥å–ä»¶ç ï¼Œå³åˆ»å¼€å§‹ä¸‹è½½</p>
                    <button class="btn-primary">å¼€å§‹æ¥æ”¶</button>
                </div>
            </div>

            <div class="features">
                <div class="feature">
                    <span class="emoji-icon">ğŸ”’</span>
                    <svg class="svg-icon icon-sm" style="display:none"><use href="#icon-lock"/></svg>
                    <span>ç«¯åˆ°ç«¯åŠ å¯†</span>
                </div>
                <div class="feature">
                    <span class="emoji-icon">âš¡</span>
                    <svg class="svg-icon icon-sm" style="display:none"><use href="#icon-zap"/></svg>
                    <span>å†…å­˜æµå¼ä¼ è¾“</span>
                </div>
                <div class="feature">
                    <span class="emoji-icon">ğŸŒ</span>
                    <svg class="svg-icon icon-sm" style="display:none"><use href="#icon-globe"/></svg>
                    <span>å…¨å¹³å°æ”¯æŒ</span>
                </div>
            </div>
        </main>

        <footer class="footer">
            <p id="copyrightText" style="cursor: pointer;">&copy; 2026 File-Rocket 5.0 â€¢ Designed for Speed</p>
        </footer>
    </div>

    <!-- ç®¡ç†å‘˜ç™»å½•å¼¹çª— -->
    <div id="adminLoginModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 9999; justify-content: center; align-items: center;">
        <div style="background: white; padding: 40px; border-radius: 20px; max-width: 400px; width: 90%; text-align: center;">
            <h2 style="margin-bottom: 20px; color: var(--text-main);">
                <span class="emoji-icon">ğŸ”</span>
                <svg class="svg-icon" style="display:none; width:24px; height:24px; vertical-align:middle"><use href="#icon-key"/></svg>
                ç®¡ç†å‘˜ç™»å½•
            </h2>
            <input type="password" id="adminPasswordInput" placeholder="è¯·è¾“å…¥ç®¡ç†å‘˜å¯†ç "
                   style="width: 100%; padding: 15px; border: 2px solid #e5e7eb; border-radius: 10px; font-size: 1rem; margin-bottom: 20px;">
            <div style="display: flex; gap: 15px;">
                <button onclick="closeAdminModal()"
                        style="flex: 1; padding: 15px; background: #e5e7eb; border: none; border-radius: 10px; font-weight: 600; cursor: pointer;">
                    å–æ¶ˆ
                </button>
                <button onclick="adminLogin()" class="admin-login-btn"
                        style="flex: 1; padding: 15px; background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%); color: white; border: none; border-radius: 10px; font-weight: 600; cursor: pointer;">
                    ç™»å½•
                </button>
            </div>
        </div>
    </div>

    <style>
        /* æç®€ä¸»é¢˜ä¸‹ç®¡ç†å‘˜ç™»å½•æŒ‰é’®æ ·å¼ */
        [data-theme="minimal"] .admin-login-btn {
            background: #1f2937 !important;
        }
    </style>

    <script>
        function goToUpload() {
            window.location.href = '/upload';
        }

        function goToReceive() {
            window.location.href = '/receive';
        }

        // ç®¡ç†å‘˜å…¥å£
        let clickCount = 0;
        let clickTimer = null;

        document.getElementById('copyrightText').addEventListener('click', function() {
            clickCount++;

            if (clickTimer) {
                clearTimeout(clickTimer);
            }

            if (clickCount >= 4) {
                showAdminModal();
                clickCount = 0;
            } else {
                clickTimer = setTimeout(() => {
                    clickCount = 0;
                }, 2000);
            }
        });

        function showAdminModal() {
            document.getElementById('adminLoginModal').style.display = 'flex';
            document.getElementById('adminPasswordInput').focus();
        }

        function closeAdminModal() {
            document.getElementById('adminLoginModal').style.display = 'none';
            document.getElementById('adminPasswordInput').value = '';
        }

        async function adminLogin() {
            const password = document.getElementById('adminPasswordInput').value;

            if (!password) {
                alert('è¯·è¾“å…¥å¯†ç ');
                return;
            }

            try {
                const response = await fetch('/api/admin/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ password })
                });

                const data = await response.json();

                if (data.success) {
                    sessionStorage.setItem('adminToken', data.token);
                    window.location.href = '/admin';
                } else {
                    alert(data.message || 'ç™»å½•å¤±è´¥');
                }
            } catch (error) {
                alert('ç™»å½•å¤±è´¥ï¼š' + error.message);
            }
        }

        // å›è½¦ç™»å½•
        document.getElementById('adminPasswordInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                adminLogin();
            }
        });

        // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
        document.getElementById('adminLoginModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeAdminModal();
            }
        });

        // ä»æœåŠ¡ç«¯åŒæ­¥ä¸»é¢˜
        fetch('/api/features').then(r => r.json()).then(data => {
            if (data.theme && data.theme !== localStorage.getItem('file-rocket-theme')) {
                localStorage.setItem('file-rocket-theme', data.theme);
                if (data.theme === 'classic') {
                    document.documentElement.removeAttribute('data-theme');
                } else {
                    document.documentElement.setAttribute('data-theme', data.theme);
                }
                var fav = document.getElementById('favicon');
                if (fav) fav.href = data.theme === 'minimal' ? 'favicon-minimal.svg' : 'favicon-classic.svg';
            }
        }).catch(() => {});
    </script>
</body>
</html>